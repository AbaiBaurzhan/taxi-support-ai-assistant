# Taxi Support AI Assistant

–î–µ–º–æ-–ø—Ä–æ–µ–∫—Ç –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ —Å–ª—É–∂–±—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ç–∞–∫—Å–∏ –Ω–∞ FastAPI —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª—å—é LLaMA.

## üöÄ –û–ø–∏—Å–∞–Ω–∏–µ

REST API —Å–µ—Ä–≤–µ—Ä —Å —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–º `/chat`, –∫–æ—Ç–æ—Ä—ã–π:
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–∫—Å—Ç, user_id –∏ locale
- –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–µ–∫—Å—Ç–∞ (—É–±–∏—Ä–∞–µ—Ç —ç–º–æ–¥–∑–∏ –∏ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã)
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —è–∑—ã–∫ (RU/KZ/EN)
- –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å (FAQ, —Å—Ç–∞—Ç—É—Å –ø–æ–µ–∑–¥–∫–∏, —á–µ–∫, –∂–∞–ª–æ–±–∞)
- –û—Ç–≤–µ—á–∞–µ—Ç –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π kb.json –¥–ª—è FAQ
- –û–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –ª–æ–∫–∞–ª—å–Ω–æ–π LLaMA –¥–ª—è –¥—Ä—É–≥–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –õ–æ–≥–∏—Ä—É–µ—Ç intent, confidence –∏ –∏—Å—Ç–æ—á–Ω–∏–∫ –æ—Ç–≤–µ—Ç–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # FastAPI —Å–µ—Ä–≤–µ—Ä —Å —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–º /chat
‚îÇ   ‚îú‚îÄ‚îÄ llm_client.py        # –ö–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å LLaMA (Ollama/transformers)
‚îÇ   ‚îú‚îÄ‚îÄ bot.py               # Telegram Bot
‚îÇ   ‚îú‚îÄ‚îÄ webapp.html          # WebApp –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îú‚îÄ‚îÄ kb.json              # –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π FAQ
‚îÇ   ‚îú‚îÄ‚îÄ fixtures.json        # –ú–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–∞–∫—Å–∏
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile           # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml   # Docker Compose
‚îÇ   ‚îú‚îÄ‚îÄ railway.toml         # Railway –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ start.sh            # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ test_api.sh         # –°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ README.md           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ README.md               # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/YOUR_USERNAME/taxi-support-ai-assistant.git
cd taxi-support-ai-assistant/backend

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
./start.sh
```

### –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
cd backend
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
python main.py
```

## üåê API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### POST /chat

–û—Å–Ω–æ–≤–Ω–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è —á–∞—Ç–∞.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "text": "–ñ–¥—É —Ç–∞–∫—Å–∏, –≥–¥–µ –≤–æ–¥–∏—Ç–µ–ª—å?",
  "user_id": "user_123",
  "locale": "ru"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "response": "–í–∞—à–∞ –ø–æ–µ–∑–¥–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ. –í–æ–¥–∏—Ç–µ–ª—å: –ê–π–¥–∞—Ä, –º–∞—à–∏–Ω–∞: Toyota Camry, –Ω–æ–º–µ—Ä: 123ABC01. –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –ø—Ä–∏–±—ã—Ç–∏—è: 5 –º–∏–Ω—É—Ç",
  "intent": "ride_status",
  "confidence": 0.95,
  "source": "kb",
  "timestamp": "2024-01-15T10:30:00"
}
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

- `GET /webapp` - WebApp –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- `GET /health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
- `GET /docs` - API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `GET /ride-status/{user_id}` - —Å—Ç–∞—Ç—É—Å –ø–æ–µ–∑–¥–∫–∏
- `POST /send-receipt/{user_id}` - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ–∫
- `GET /cards/{user_id}` - —Å–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç
- `POST /escalate/{user_id}` - —ç—Å–∫–∞–ª–∞—Ü–∏—è –∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä—É

## ü§ñ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏–Ω—Ç–µ–Ω—Ç—ã

1. **FAQ** - –≤–æ–ø—Ä–æ—Å—ã –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π (—Ü–µ–Ω–∞, –ø—Ä–æ–º–æ–∫–æ–¥—ã, –æ—Ç–º–µ–Ω–∞)
2. **ride_status** - —Å—Ç–∞—Ç—É—Å –ø–æ–µ–∑–¥–∫–∏ ("–≥–¥–µ –≤–æ–¥–∏—Ç–µ–ª—å")
3. **receipt** - –∑–∞–ø—Ä–æ—Å —á–µ–∫–∞ ("–ø—Ä–∏—à–ª–∏—Ç–µ —á–µ–∫")
4. **cards** - —Ä–∞–±–æ—Ç–∞ —Å –∫–∞—Ä—Ç–∞–º–∏ ("–∫–∞–∫–∏–µ –∫–∞—Ä—Ç—ã", "—Å–¥–µ–ª–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π")
5. **complaint** - –∂–∞–ª–æ–±—ã ("—Å–ø–∏—Å–∞–ª–∏ –¥–≤–∞–∂–¥—ã")

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ API
./test_api.sh
```

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –°—Ç–∞—Ç—É—Å –ø–æ–µ–∑–¥–∫–∏
curl -X POST "http://localhost:8000/chat" \
  -H "Content-Type: application/json" \
  -d '{"text": "–ñ–¥—É —Ç–∞–∫—Å–∏, –≥–¥–µ –≤–æ–¥–∏—Ç–µ–ª—å?", "user_id": "user_123", "locale": "ru"}'

# FAQ
curl -X POST "http://localhost:8000/chat" \
  -H "Content-Type: application/json" \
  -d '{"text": "–ö–∞–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ü–µ–Ω–∞ –ø–æ–µ–∑–¥–∫–∏?", "user_id": "user_123", "locale": "ru"}'

# WebApp
open http://localhost:8000/webapp
```

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Railway (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫ Railway: https://railway.app
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   - `BOT_TOKEN` - —Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
   - `API_URL` - URL –≤–∞—à–µ–≥–æ Railway –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
4. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–≤–µ—Ä–Ω–µ—Ç –ø—Ä–æ–µ–∫—Ç

### Docker

```bash
# –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å Docker Compose
docker-compose up -d

# –ò–ª–∏ —Ç–æ–ª—å–∫–æ API
docker build -t taxi-support .
docker run -p 8000:8000 taxi-support
```

### Telegram Bot

1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather
2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `BOT_TOKEN`
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞: `python bot.py`

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É Ollama –∏ Transformers

–í `llm_client.py` –∏–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `use_ollama`:

```python
# –î–ª—è Ollama (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
llm_client = LLMClient(use_ollama=True)

# –î–ª—è Transformers
llm_client = LLMClient(use_ollama=False, model_name="microsoft/DialoGPT-medium")
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–∏ Ollama

–í `llm_client.py` –∏–∑–º–µ–Ω–∏—Ç–µ `model_name`:

```python
self.model_name = "llama2"  # –∏–ª–∏ "llama2:7b", "codellama", etc.
```

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–µ—Ä–≤–µ—Ä –ª–æ–≥–∏—Ä—É–µ—Ç:
- –í—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã (user_id, intent, confidence, locale)
- –û—Ç–≤–µ—Ç—ã (–ø–µ—Ä–≤—ã–µ 100 —Å–∏–º–≤–æ–ª–æ–≤, –∏—Å—Ç–æ—á–Ω–∏–∫, –∏–Ω—Ç–µ–Ω—Ç, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å)
- –û—à–∏–±–∫–∏ —Ä–∞–±–æ—Ç—ã —Å LLM

## üóÉÔ∏è –ú–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

–î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `fixtures.json`:
- **rides** - –∞–∫—Ç–∏–≤–Ω—ã–µ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏
- **receipts** - —á–µ–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **cards** - –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã
- **tickets** - —Ç–∏–∫–µ—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏

## üìö –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π

FAQ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `kb.json` —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞.

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.9+
- Ollama (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π LLaMA) –∏–ª–∏ Transformers
- 4GB+ RAM (–¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–µ–ª—è–º–∏)

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
3. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã, —Å–æ–∑–¥–∞–π—Ç–µ Issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
