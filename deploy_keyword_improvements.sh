#!/bin/bash

# üöÄ –î–µ–ø–ª–æ–π —É–ª—É—á—à–µ–Ω–∏–π –ø–æ–∏—Å–∫–∞ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
# –ê–≤—Ç–æ—Ä: AI Assistant
# –î–∞—Ç–∞: $(date '+%Y-%m-%d %H:%M:%S')

echo "üöÄ –î–ï–ü–õ–û–ô –£–õ–£–ß–®–ï–ù–ò–ô –ü–û–ò–°–ö–ê –ü–û –ö–õ–Æ–ß–ï–í–´–ú –°–õ–û–í–ê–ú"
echo "================================================================================="

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
if [ ! -f "backend/main.py" ]; then
    echo "‚ùå –û—à–∏–±–∫–∞: —Ñ–∞–π–ª backend/main.py –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞."
    exit 1
fi

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
echo "üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã..."
pkill -f "python3 main.py" 2>/dev/null || true
sleep 2

# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
echo "üîß –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ..."
source venv_deploy/bin/activate

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å git
echo "üìã –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å Git..."
git status

# –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã
echo "üìÅ –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã –≤ Git..."
git add .

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –∫–æ–º–º–∏—Ç–∞
if git diff --staged --quiet; then
    echo "‚ÑπÔ∏è  –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∫–æ–º–º–∏—Ç–∞."
else
    echo "üíæ –°–æ–∑–¥–∞–µ–º –∫–æ–º–º–∏—Ç —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏ –ø–æ–∏—Å–∫–∞ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º..."
    git commit -m "üîç –£–ª—É—á—à–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º

‚ú® –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ (—Ä–∞—Å—Ü–µ–Ω–∫–∞: 20, –Ω–∞—Ü–µ–Ω–∫–∞: 15, –æ–±—â–∏–µ: 3)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–Ω—Ç–µ–Ω—Ç–æ–≤
- –õ–æ–≥–∏–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö FAQ
- –£–ª—É—á—à–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥—Å—á–µ—Ç–∞ –æ—á–∫–æ–≤

üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —É–ª—É—á—à–µ–Ω–∏–π:
- –û–±—â–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: 69.8% ‚Üí 75.5% (+5.7%)
- –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: 35.1% ‚Üí 38.3% (+3.2%)
- –í–∞—Ä–∏–∞—Ü–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤: 91.4% ‚Üí 98.7% (+7.3%)

üèÜ FAQ —Å 100% —Ç–æ—á–Ω–æ—Å—Ç—å—é:
1. –ß—Ç–æ —Ç–∞–∫–æ–µ –Ω–∞—Ü–µ–Ω–∫–∞? (100.0%)
2. –ß—Ç–æ —Ç–∞–∫–æ–µ –¢–∞—Ä–∏—Ñ –ö–æ–º—Ñ–æ—Ä—Ç? (100.0%)
3. –ß—Ç–æ —Ç–∞–∫–æ–µ –¥–æ—Å—Ç–∞–≤–∫–∞? (100.0%)

üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:
- –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö —Å–ª–æ–≤ –Ω–∞–¥ –æ–±—â–∏–º–∏
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö FAQ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ
- –ë–æ–Ω—É—Å—ã –∏ —à—Ç—Ä–∞—Ñ—ã –¥–ª—è —Ç–æ—á–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è –ø–æ—Ö–æ–∂–∏—Ö —Å–ª–æ–≤

üìÑ –û—Ç—á–µ—Ç—ã:
- KEYWORD_SEARCH_IMPROVEMENT_REPORT.md
- individual_kb_test_results.json
- test_individual_kb_items.py

‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã:
- –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ 100% —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
- –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –º–µ–∂–¥—É FAQ"
fi

# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ GitHub
echo "üöÄ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ GitHub..."
git push origin main

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
if [ $? -eq 0 ]; then
    echo ""
    echo "üéâ –î–ï–ü–õ–û–ô –£–õ–£–ß–®–ï–ù–ò–ô –ó–ê–í–ï–†–®–ï–ù –£–°–ü–ï–®–ù–û!"
    echo "================================================================================="
    echo "üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —É–ª—É—á—à–µ–Ω–∏–π –ø–æ–∏—Å–∫–∞ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º:"
    echo "   ‚Ä¢ –û–±—â–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: 69.8% ‚Üí 75.5% (+5.7%)"
    echo "   ‚Ä¢ –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: 35.1% ‚Üí 38.3% (+3.2%)"
    echo "   ‚Ä¢ –í–∞—Ä–∏–∞—Ü–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤: 91.4% ‚Üí 98.7% (+7.3%)"
    echo ""
    echo "üèÜ FAQ —Å 100% —Ç–æ—á–Ω–æ—Å—Ç—å—é:"
    echo "   1. –ß—Ç–æ —Ç–∞–∫–æ–µ –Ω–∞—Ü–µ–Ω–∫–∞? (100.0%)"
    echo "   2. –ß—Ç–æ —Ç–∞–∫–æ–µ –¢–∞—Ä–∏—Ñ –ö–æ–º—Ñ–æ—Ä—Ç? (100.0%)"
    echo "   3. –ß—Ç–æ —Ç–∞–∫–æ–µ –¥–æ—Å—Ç–∞–≤–∫–∞? (100.0%)"
    echo ""
    echo "üîß –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:"
    echo "   ‚Ä¢ –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤"
    echo "   ‚Ä¢ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–Ω—Ç–µ–Ω—Ç–æ–≤"
    echo "   ‚Ä¢ –õ–æ–≥–∏–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö FAQ"
    echo "   ‚Ä¢ –£–ª—É—á—à–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥—Å—á–µ—Ç–∞ –æ—á–∫–æ–≤"
    echo ""
    echo "‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã:"
    echo "   ‚Ä¢ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ 100% —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º"
    echo "   ‚Ä¢ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –º–µ–∂–¥—É FAQ"
    echo "   ‚Ä¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ç—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞ –Ω–∞–¥ –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º"
    echo ""
    echo "üìÑ –û—Ç—á–µ—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã:"
    echo "   ‚Ä¢ KEYWORD_SEARCH_IMPROVEMENT_REPORT.md"
    echo "   ‚Ä¢ individual_kb_test_results.json"
    echo "   ‚Ä¢ test_individual_kb_items.py"
    echo ""
    echo "üîó GitHub: https://github.com/AbaiBaurzhan/taxi-support-ai-assistant.git"
    echo "================================================================================="
else
    echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –Ω–∞ GitHub. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞."
    exit 1
fi

echo "‚úÖ –î–µ–ø–ª–æ–π —É–ª—É—á—à–µ–Ω–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!"
